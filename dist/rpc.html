<!DOCTYPE html><html><head><title>RPC Test</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;text y='.95em' font-size='90' x='-.1em'&gt;ðŸ”—&lt;/text&gt;&lt;/svg&gt;"><script type="module" src="/rpc.js"></script><style>html,body{position:relative;margin:0;height:100%;font-family:Helvetica Neue,sans-serif;overflow:visible;overscroll-behavior:auto}*{-webkit-tap-highlight-color:transparent}body{display:flex;flex-direction:column}label{margin:8px;position:relative;display:flex;flex-direction:column;font-size:16px}input{border:1px solid #999;padding:2px 8px;font:inherit;outline:none;background:#f9f9f9;position:relative;border-radius:4px}input:focus{background:#fff}#autocomplete{position:absolute;top:0;left:0;right:0;background:#eee;box-shadow:0 0 2px 2px #00000026;padding-top:24px;border-radius:4px}#autocomplete>*{padding:2px 4px;cursor:pointer;user-select:none;white-space:pre}#autocomplete>*+*{border-top:1px solid #999}#autocomplete>.active{background-color:#aaa}#buttonbar{display:flex;margin:0 8px;flex-wrap:wrap;gap:4px}#buttonbar>*{border-radius:14px;padding:4px 8px;border:1px solid black;color:#333;background-color:#d3d3d3}#buttonbar>:not(#status){cursor:pointer;user-select:none;color:#333;background-color:#d3d3d3}#status{margin-left:auto}pre{margin:8px;padding:8px;border-radius:8px;tab-size:4;overflow:auto;scrollbar-width:thin;scrollbar-color:green transparent}
</style></head><body><label><div id="autocomplete"></div><input type="text" value="Rpc.getRegistrations()"></label><div id="buttonbar"><span id="execute">Execute</span><span id="copy">Copy Result</span><span id="status">Waiting for input</span></div><pre id="result"></pre><script>"use strict";const input=document.querySelector("input"),autocomplete=document.querySelector("#autocomplete"),result=document.querySelector("#result"),copy=document.querySelector("#copy");function setStatus(e,t,n,l){const o=new Date(l-new Date().getTimezoneOffset()*1e3*60).toJSON(),c=document.querySelector("#status");c.textContent=`${e} (${o.replace("T"," ").replace("Z","")})`,c.style.color=t,c.style.backgroundColor=n}let curr=0;async function runEval(e=()=>Rpc.evalString(input.value)){for(;autocomplete.firstChild;)autocomplete.removeChild(autocomplete.lastChild);last="";const t=++curr,n=Date.now();try{setStatus("Executing","cyan","blue",n),result.style.backgroundColor="rgba(0,0,255,10%)",result.style.scrollbarColor="rgb(0,0,128) transparent";const l=await e();if(t!=curr)return;result.textContent=l,result.style.backgroundColor="rgba(0,255,0,10%)",result.style.scrollbarColor="rgb(0,128,0) transparent";const o=Date.now();setStatus(`Success (${((o-n)/1e3).toFixed(3)}s)`,"lime","green",Date.now())}catch(l){if(t!=curr)return;result.textContent=l.trashLocalStack()+`


Exception data:`+JSON.stringify(l.data,null,"	"),result.style.backgroundColor="rgba(255,0,0,10%)",result.style.scrollbarColor="rgb(128,0,0) transparent";const o=Date.now();setStatus(`Failed (${((o-n)/1e3).toFixed(3)}s)`,"orangered","darkred",Date.now())}}let copyTimeout;copy.addEventListener("click",()=>{const e=document.createElement("textarea");e.value=result.textContent,e.style.position="fixed",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),copy.style.color="lime",copy.style.backgroundColor="darkgreen",clearTimeout(copyTimeout),copyTimeout=setTimeout(()=>{copy.style.color=null,copy.style.backgroundColor=null},250)}),document.querySelector("#execute").addEventListener("click",()=>runEval()),input.addEventListener("keydown",async e=>{let t;switch(e.key){case"ArrowUp":e.preventDefault(),t=autocomplete.querySelector(":scope>.active"),t?(t.classList.remove("active"),(t=t.previousElementSibling??t).classList.add("active")):(t=autocomplete.lastElementChild)?.classList.add("active");break;case"ArrowDown":e.preventDefault(),t=autocomplete.querySelector(":scope>.active"),t?(t.classList.remove("active"),(t=t.nextElementSibling??t).classList.add("active")):(t=autocomplete.firstElementChild)?.classList.add("active");break;case"Tab":e.preventDefault(),t=autocomplete.querySelector(":scope>.active,:scope>:only-child"),t?.onclick(null);return;case"Enter":e.preventDefault(),t=autocomplete.querySelector(":scope>.active"),t?t.onclick(null):runEval().catch(console.error);return;case"Escape":for(e.preventDefault();autocomplete.firstChild;)autocomplete.removeChild(autocomplete.lastChild);last="";return;case" ":case"Space":(e.altKey||e.shiftKey||e.ctrlKey)&&(updateAutoComplete(),e.preventDefault());return;default:return}}),input.addEventListener("input",updateAutoComplete),input.addEventListener("selectionchange",updateAutoComplete),document.addEventListener("selectionchange",updateAutoComplete);let last;async function updateAutoComplete(){const e=input.parentElement.matches(":focus-within")?input.selectionStart+"|"+input.selectionEnd+"|"+input.value:"";if(e==last)return;last=e;let t=e?await getAutoComplete():[];for(;autocomplete.firstChild;)autocomplete.removeChild(autocomplete.lastChild);autocomplete.append(...t)}let cachedTypes=null,cachedTypesTimeout,cachedMethodsType=null,cachedMethods=null,cachedMethodsTimeout;async function getAutoComplete(){let e=input.selectionStart??1/0,t=input.selectionEnd??1/0;e>t&&([e,t]=[t,e]);const n=input.value;let l=n.indexOf("(");if(l==-1)l=n.length;else if(t>l)return[];let o=n.lastIndexOf(".",l);if(o==-1||t<=o){cachedTypes??=Rpc.getAllTypes().finally(()=>console.log("Catching types")),clearTimeout(cachedTypesTimeout),cachedTypesTimeout=setTimeout(()=>cachedTypes=null,1e3);let c;try{c=await cachedTypes}catch(s){const r=document.createElement("div");return r.textContent="Error getting types: "+s.message,[r]}const d=n.substring(0,e);return d[0]!="$"&&(c=c.filter(s=>s[0]!="$")),c.filter(s=>s.startsWith(d)).map(s=>{const r=document.createElement("div"),a=r.appendChild(document.createElement("i"));return a.appendChild(document.createTextNode(d)),a.appendChild(document.createElement("b")).textContent=s.substring(d.length),r.appendChild(document.createTextNode(o!=-1?n.substring(o):".")),r.onclick=()=>{input.focus(),document.execCommand("selectAll",!1,null),document.execCommand("insertText",!1,r.textContent??""),input.selectionStart=input.selectionEnd=s.length+1},r})}else if(e>o){const c=n.substring(0,o);cachedMethodsType!=c&&(cachedMethodsType=c,cachedMethods=null);const d=cachedMethodsType;cachedMethods??=Rpc.createObject(cachedMethodsType)[RpcObjectGetMethods]().finally(()=>console.log("Catching methods for "+d)),clearTimeout(cachedMethodsTimeout),cachedMethodsTimeout=setTimeout(()=>cachedMethods=null,1e3);let s;try{s=await cachedMethods}catch(a){const i=document.createElement("div");return i.textContent="Error getting methods: "+a.message,i.style.backgroundColor="rgba(255,0,0,10%)",[i]}const r=n.substring(o+1,e);return s.filter(a=>a.toLowerCase().startsWith(r.toLowerCase())).map(a=>{const i=document.createElement("div");i.appendChild(document.createTextNode(d+"."));const u=i.appendChild(document.createElement("i"));return u.appendChild(document.createTextNode(a.substring(0,r.length))),u.appendChild(document.createElement("b")).textContent=a.substring(r.length),i.appendChild(document.createTextNode(n.length<=l?"()":n.substring(l))),i.onclick=()=>{input.focus(),document.execCommand("selectAll",!1,null),document.execCommand("insertText",!1,i.textContent??""),input.selectionStart=input.selectionEnd=d.length+a.length+2},i})}else return[]}
</script></body></html>